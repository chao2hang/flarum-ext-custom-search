{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3ER,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,mBCAlF,MAAM,EAA+BI,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCGxDC,IAAAA,aAAiBC,IAAI,qBAAsB,YCMzCC,EAAAA,EAAAA,QAAOC,IAAAA,UAAkB,SAAU,WACjCC,KAAKC,aAAe,MACtB,IAGAC,EAAAA,EAAAA,UAASH,IAAAA,UAAkB,OAAQ,SAAUI,GAAU,IAAAC,EAAA,KAC/CC,EAAQF,IAGRG,EAAcD,EAAME,SAASC,KAAK,SAACC,GAAM,OAAKA,GAAKA,EAAEC,OAASD,EAAEC,MAAMC,WAAaF,EAAEC,MAAMC,UAAUC,SAAS,eAAe,GAuCnI,OArCIN,IACGO,MAAMC,QAAQR,EAAYC,YAC7BD,EAAYC,SAAW,CAACD,EAAYC,WAItCD,EAAYC,SAASQ,QACnBC,EAAA,OAAKL,UAAU,0BACbK,EAACC,IAAM,CACLC,QAAS,CACPC,OAAQ,SACRC,KAAM,QAERC,MAAOrB,KAAKC,aACZqB,SAAU,SAACD,GACTjB,EAAKH,aAAeoB,EACpBL,EAAEO,QACJ,MAMNjB,EAAYC,SAASiB,KACnBR,EAAA,UACEL,UAAU,oCACVc,QAAS,SAACC,GACRA,EAAEC,iBACFvB,EAAKwB,cACP,EACAC,KAAK,UAEJC,IAAK,oBAKLzB,CACT,IAGAH,EAAAA,EAAAA,UAASH,IAAAA,UAAkB,eAAgB,SAAUI,GACnD,IAAM4B,EAAQ/B,KAAKgC,YAAYC,WAC/B,GAAKF,KAASA,EAAMG,OAAS,GAA7B,CAEA,IAAMC,EAAU,IAAIC,IAAIxC,IAAAA,MAAUyC,UAAU,YAAYC,SAClDC,EAAwC,CAC5CpB,OAAQ,wCAAwCgB,EAAO,MAAMK,mBAAmBT,GAChFX,KAAM,sCAAsCe,EAAO,MAAMK,mBAAmBT,IAG9EU,OAAOC,KAAKH,EAAcvC,KAAKC,cAAe,UAC9CD,KAAK2C,QACL3C,KAAK4C,EAAE,SAASC,MAVsB,CAWxC,IAGA3C,EAAAA,EAAAA,UAASH,IAAAA,UAAkB,cAAe,WACxC,OAAO,IAAI+C,IACb,ED1EF,E","sources":["webpack://@nopj/flarum-ext-custom-search/webpack/bootstrap","webpack://@nopj/flarum-ext-custom-search/webpack/runtime/compat get default export","webpack://@nopj/flarum-ext-custom-search/webpack/runtime/define property getters","webpack://@nopj/flarum-ext-custom-search/webpack/runtime/hasOwnProperty shorthand","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['forum/app']\"","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['common/extend']\"","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['forum/components/Search']\"","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['common/components/Select']\"","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@nopj/flarum-ext-custom-search/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nopj/flarum-ext-custom-search/./src/forum/index.ts","webpack://@nopj/flarum-ext-custom-search/./src/forum/components/CustomSearch.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Search'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import app from 'flarum/forum/app';\r\nimport extendSearch from './components/CustomSearch';\r\n\r\napp.initializers.add('nopj/custom-search', () => {\r\n  extendSearch();\r\n});\r\n","import app from 'flarum/forum/app';\r\nimport { extend, override } from 'flarum/common/extend';\r\nimport Search from 'flarum/forum/components/Search';\r\nimport Select from 'flarum/common/components/Select';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport icon from 'flarum/common/helpers/icon';\r\n\r\nexport default function extendSearch() {\r\n  // Initialize searchEngine property\r\n  extend(Search.prototype, 'oninit', function () {\r\n    this.searchEngine = 'bing';\r\n  });\r\n\r\n  // Override view to add the engine selector\r\n  override(Search.prototype, 'view', function (original) {\r\n    const vnode = original();\r\n    \r\n    // Find the Search-input div in the children\r\n    const searchInput = vnode.children.find((c: any) => c && c.attrs && c.attrs.className && c.attrs.className.includes('Search-input'));\r\n    \r\n    if (searchInput) {\r\n      if (!Array.isArray(searchInput.children)) {\r\n        searchInput.children = [searchInput.children];\r\n      }\r\n\r\n      // Prepend the engine selector\r\n      searchInput.children.unshift(\r\n        <div className=\"Search-engine-selector\">\r\n          <Select\r\n            options={{\r\n              google: 'Google',\r\n              bing: 'Bing'\r\n            }}\r\n            value={this.searchEngine}\r\n            onchange={(value: string) => {\r\n              this.searchEngine = value;\r\n              m.redraw();\r\n            }}\r\n          />\r\n        </div>\r\n      );\r\n\r\n      // Add a search button at the end\r\n      searchInput.children.push(\r\n        <button\r\n          className=\"Button Button--link Search-button\"\r\n          onclick={(e: Event) => {\r\n            e.preventDefault();\r\n            this.selectResult();\r\n          }}\r\n          type=\"button\"\r\n        >\r\n          {icon('fas fa-search')}\r\n        </button>\r\n      );\r\n    }\r\n\r\n    return vnode;\r\n  });\r\n\r\n  // Override selectResult to redirect to external search engine\r\n  override(Search.prototype, 'selectResult', function (original) {\r\n    const query = this.searchState.getValue();\r\n    if (!query || query.length < 1) return;\r\n\r\n    const baseUrl = new URL(app.forum.attribute('baseUrl')).hostname;\r\n    const searchQueries: Record<string, string> = {\r\n      google: `https://www.google.com/search?q=site:${baseUrl}%20${encodeURIComponent(query)}`,\r\n      bing: `https://www.bing.com/search?q=site:${baseUrl}%20${encodeURIComponent(query)}`\r\n    };\r\n\r\n    window.open(searchQueries[this.searchEngine], '_blank');\r\n    this.clear();\r\n    this.$('input').blur();\r\n  });\r\n\r\n  // Empty sourceItems to stop Flarum's internal search from showing results\r\n  override(Search.prototype, 'sourceItems', function () {\r\n    return new ItemList();\r\n  });\r\n}\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","extend","Search","this","searchEngine","override","original","_this","vnode","searchInput","children","find","c","attrs","className","includes","Array","isArray","unshift","m","Select","options","google","bing","value","onchange","redraw","push","onclick","e","preventDefault","selectResult","type","icon","query","searchState","getValue","length","baseUrl","URL","attribute","hostname","searchQueries","encodeURIComponent","window","open","clear","$","blur","ItemList"],"sourceRoot":""}